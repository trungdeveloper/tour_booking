var Searchbox = function () { var e = function () { var e = $("#mess-outofdate").length > 0 ? $("#mess-outofdate").html() : "Giới hạn cho mỗi lần đặt phòng chỉ là 30 đêm. Khách sạn sẽ rất vui nếu quý khách muốn ở lâu hơn, vui lòng liên hệ <strong>HOTLINE</strong> (028) 3930 8290 để được hướng dẫn thêm."; $("#ivivuModal").find(".modal-body").html(e), $("#ivivuModal").modal("show") }, t = function () { $("#datepicker-home-chkin, #datepicker-home-chkout, #datepicker-menu-chkin, #datepicker-menu-chkout, #datepicker-detail-chkin, #datepicker-detail-chkout,.datepicker-detail-chkout2, #datepicker-search-chkin, #datepicker-search-chkout, #datepicker-modal-chkin, #datepicker-modal-chkout,#datepicker-detail-chkin2, #ip_pr_checkin, #ip_pr_checkout").off("dp.change").off("keydown"), $("#datepicker-home-nights, #datepicker-menu-nights, #datepicker-detail-nights, #datepicker-search-nights, #datepicker-modal-nights").off("change"), $("i.icn-datecheckin, i.icn-datecheckout").off("click") }, i = function () { $("#datepicker-home-chkin, #datepicker-home-chkout, #datepicker-menu-chkin, #datepicker-menu-chkout, #datepicker-detail-chkin,.datepicker-detail-chkin2, #datepicker-detail-chkout,#datepicker-detail-chkout2, #datepicker-search-chkin, #datepicker-search-chkout, #datepicker-modal-chkin, #datepicker-modal-chkout, #ip_pr_checkin, #ip_pr_checkout").on("dp.change", function () { $(this).trigger("blur"), h($(this).attr("id")) }).on("keydown", function (e) { 13 == e.which && ($(this).trigger("change"), e.preventDefault()) }), $("#datepicker-home-nights, #datepicker-menu-nights, #datepicker-detail-nights, #datepicker-search-nights, #datepicker-modal-nights").on("change", function () { $(this).trigger("blur"), h($(this).attr("id")) }), $("i.icn-datecheckin, i.icn-datecheckout").on("click", function () { $(this).siblings("input").focus() }) }, a = function (e, a, c) { { var n = $(e).val(), r = $(a).val(), o = $(c).val(); $(e).attr("id").split("-")[1] } t(), $(".datepicker-chkin").each(function () { $(this).val(n), $(this).data("DateTimePicker").date(Static.stringToDate(n)) }), $(".datepicker-nights").each(function () { $(this).val(r) }), $(".datepicker-chkout").each(function () { $(this).val(o), $(this).data("DateTimePicker").date(Static.stringToDate(o)); var e = Static.stringToDate(n); e.setTime(e.getTime() + 864e5) }); var d = Static.stringToDate(n); d.setTime(d.getTime() + 864e5), Static.updateDatesCookies(e, c), i(e, c) }, c = function (e, t, i) { var c = $(e).val(), n = $(t).val(), r = $(i).val(); if (0 == c.length) { var o = Static.stringToDate(r); return o.setTime(o.getTime() - 864e5 * n), $(e).val(Static.dateToString(o)), null } if ("" == c) { var o = Static.stringToDate(r); return o.setTime(o.getTime() - 864e5 * n), $(e).val(Static.dateToString(o)), null } var o = Static.stringToDate(c); o.setTime(o.getTime() + 864e5 * n), $(i).val(Static.dateToString(o)); var d = Static.stringToDate(c); return d.setTime(d.getTime() + 864e5), a(e, t, i), null }, n = function (t, i, c) { var n = $(t).val(), r = $(i).val(), o = $(c).val(); if (0 == o.length) { var d = Static.stringToDate(n); return d.setTime(d.getTime() + 864e5 * r), $(c).val(Static.dateToString(d)), null } if ("" == o) { var d = Static.stringToDate(n); return d.setTime(d.getTime() + 864e5 * r), $(c).val(Static.dateToString(d)), null } var h = Static.stringToDate(n), k = Static.stringToDate(o); return k.getTime() > h.getTime() + 2592e6 ? (e(), r = 30, k.setTime(h.getTime() + 864e5 * r), $(i).val(r), $(c).val(Static.dateToString(k))) : (r = (k.getTime() - h.getTime()) / 864e5, 0 >= r && (r = 1), $(i).val(r)), a(t, i, c), null }, r = function (t, i, c) { var n = $(t).val(), r = $(i).val(); 0 == r && (e(), r = 30, $(i).val(r)); var o = Static.stringToDate(n); o.setTime(o.getTime() + 864e5 * r), $(c).val(Static.dateToString(o)); var d = Static.stringToDate(n); d.setTime(d.getTime() + 864e5), a(t, i, c) }, o = function (e, t) { var i = Static.readCookie("di"), a = Static.readCookie("do"); if (null != i || void 0 != i) { var c = moment().subtract(1, "days").toDate(), n = moment().toDate(); $("#" + e).datetimepicker({ useCurrent: !1, ignoreReadonly: !0, format: "DD-MM-YYYY", minDate: c }), $("#" + e).val(i), $("#" + t).datetimepicker({ useCurrent: !1, ignoreReadonly: !0, format: "DD-MM-YYYY", minDate: n }), $("#" + t).val(a) } else $("#" + e).length > 0 && ("" === $("#" + e).val() && $("#" + e).val(Static.moreDate(1)), $("#" + e).datetimepicker({ ignoreReadonly: !0, format: "DD-MM-YYYY", minDate: Static.stringToDate(Static.moreDate(0)) })), $("#" + t).length > 0 && ("" === $("#" + t).val() && $("#" + t).val(Static.moreDate(2)), $("#" + t).datetimepicker({ ignoreReadonly: !0, format: "DD-MM-YYYY", minDate: Static.stringToDate(Static.nextDate($("#" + e).val(), 1)) })) }, d = function (e, t) { $("#" + e).length > 0 && void 0 != $("#" + e).data("DateTimePicker") && $("#" + e).data("DateTimePicker").destroy(), $("#" + t).length > 0 && void 0 != $("#" + t).data("DateTimePicker") && $("#" + t).data("DateTimePicker").destroy() }, h = function (e) { switch (e) { case "datepicker-home-nights": r($("#datepicker-home-chkin"), $("#datepicker-home-nights"), $("#datepicker-home-chkout")); break; case "datepicker-home-chkin": c($("#datepicker-home-chkin"), $("#datepicker-home-nights"), $("#datepicker-home-chkout")); break; case "datepicker-home-chkout": n($("#datepicker-home-chkin"), $("#datepicker-home-nights"), $("#datepicker-home-chkout")); break; case "datepicker-menu-nights": r($("#datepicker-menu-chkin"), $("#datepicker-menu-nights"), $("#datepicker-menu-chkout")); break; case "datepicker-menu-chkin": c($("#datepicker-menu-chkin"), $("#datepicker-menu-nights"), $("#datepicker-menu-chkout")); break; case "datepicker-menu-chkout": n($("#datepicker-menu-chkin"), $("#datepicker-menu-nights"), $("#datepicker-menu-chkout")); break; case "datepicker-detail-nights": r($("#datepicker-detail-chkin"), $("#datepicker-detail-nights"), $("#datepicker-detail-chkout"), $("#datepicker-detail-chkin2"), $("#datepicker-detail-chkout")); break; case "datepicker-detail-chkin": c($("#datepicker-detail-chkin"), $("#datepicker-detail-nights"), $("#datepicker-detail-chkout"), $("#datepicker-detail-chkin2"), $("#datepicker-detail-chkout")); break; case "datepicker-detail-chkout": n($("#datepicker-detail-chkin"), $("#datepicker-detail-nights"), $("#datepicker-detail-chkout"), $("#datepicker-detail-chkin2"), $("#datepicker-detail-chkout")); break; case "datepicker-search-nights": r($("#datepicker-search-chkin"), $("#datepicker-search-nights"), $("#datepicker-search-chkout")); break; case "datepicker-search-chkin": c($("#datepicker-search-chkin"), $("#datepicker-search-nights"), $("#datepicker-search-chkout")); break; case "datepicker-search-chkout": n($("#datepicker-search-chkin"), $("#datepicker-search-nights"), $("#datepicker-search-chkout")); break; case "datepicker-modal-nights": r($("#datepicker-modal-chkin"), $("#datepicker-modal-nights"), $("#datepicker-modal-chkout")); break; case "datepicker-modal-chkin": c($("#datepicker-modal-chkin"), $("#datepicker-modal-nights"), $("#datepicker-modal-chkout")); break; case "datepicker-modal-chkout": n($("#datepicker-modal-chkin"), $("#datepicker-modal-nights"), $("#datepicker-modal-chkout")); break; case "ip_pr_checkin": c($("#ip_pr_checkin"), $("#datepicker-menu-nights"), $("#ip_pr_checkout")); break; case "ip_pr_checkout": n($("#ip_pr_checkin"), $("#datepicker-menu-nights"), $("#ip_pr_checkout")); break; } }, k = function () { $("#search-home-text, #search-menu-text, #search-search-text").keydown(function (e) { return e.which >= 186 && e.which <= 192 || e.which >= 219 && e.which <= 222 || e.which >= 48 && e.which <= 54 && e.shiftKey || e.which >= 56 && e.which <= 57 && e.shiftKey || e.which >= 107 && e.which <= 111 ? !1 : void (13 == e.which) }), Static.readDatesCookies(), o("datepicker-menu-chkin", "datepicker-menu-chkout", "datepicker-menu-nights"), o("datepicker-home-chkin", "datepicker-home-chkout", "datepicker-home-nights"), o("datepicker-detail-chkin", "datepicker-detail-chkout", "datepicker-detail-nights"), o("datepicker-search-chkin", "datepicker-search-chkout", "datepicker-search-nights"), o("ip_pr_checkin", "ip_pr_checkout", "nothing"), i() }, l = function () { $(".menu-search").click(function () { $(".header-search-form__outer, .hotel-list-search-container").toggle(),$("header .header-navigation").length>0&&($("header").removeClass("menuOpened"),$("header").find(".header-navigation").hide())}),$(document).mouseup(function(e){var t=$(".top-search"),i=$(".header-search-form__outer");t.is(e.target)||0!==t.has(e.target).length||i.is(e.target)||0!==i.has(e.target).length||t.hide()})};return{init:function(){k(),l()},initDatepicker:function(e,t){o(e,t)},destroyDatepicker:function(e,t){d(e,t)},bindDatepicker:function(){i()},unbindDatepicker:function(){t()}}}(),Payrequest=function(){var e=function(){$("#ivivuModal .prg-submit").length>0&&$("#ivivuModal .prg-submit").on("click",function(){if(!$(this).hasClass("disabled")){var e="",t=Static.validNull($("#ivivuModal input[name=modal-cusname]").val()),i=Static.validFone($("#ivivuModal input[name=modal-cusfone]").val()),a=Static.validMail($("#ivivuModal input[name=modal-cusmail]").val());if(t?$("#ivivuModal input[name=modal-cusname]").removeClass("bc-1s-red"):(e+="\n- Họ và tên",$("#ivivuModal input[name=modal-cusname]").addClass("bc-1s-red")),i?$("#ivivuModal input[name=modal-cusfone]").removeClass("bc-1s-red"):(e+="\n- Số điện thoại",$("#ivivuModal input[name=modal-cusfone]").addClass("bc-1s-red")),a?$("#ivivuModal input[name=modal-cusmail]").removeClass("bc-1s-red"):(e+="\n- Email",$("#ivivuModal input[name=modal-cusmail]").addClass("bc-1s-red")),!(t&&i&&a))return swal({title:"Thông tin không hợp lệ:",text:e,timer:16e3,type:"warning"}),!1;$(this).off("click").addClass("disabled");var c="",n="",r=null;$(".htldtl-avatar").length>0&&(c=$(".htldtl-avatar").text()),$(".htldtl-address").length>0&&(n=$(".htldtl-address").text()),"undefined"!=typeof RoomPriceObject&&(r=RoomPriceObject);var o=Static.readCookie("adults"),d=Static.readCookie("child"),h=Static.readCookie("totalroom"),k=JSON.stringify({HotelId:Static.defaultValue($("#ivivuModal input[name=modal-hotelid]").val(),0),HotelName:$("#ivivuModal input[name=modal-hotelname]").val(),RegionId:Static.defaultValue($("#ivivuModal input[name=modal-regionid]").val(),0),RegionName:$("#ivivuModal input[name=modal-regioname]").val(),CheckIn:Static.stringToDateTime($("#ivivuModal input[name=datepicker-modal-chkin]").val()),CheckOut:Static.stringToDateTime($("#ivivuModal input[name=datepicker-modal-chkout]").val()),CustomerName:$("#ivivuModal input[name=modal-cusname]").val(),Email:$("#ivivuModal input[name=modal-cusmail]").val(),Phone:Static.removeFoneSpec($("#ivivuModal input[name=modal-cusfone]").val()),RequestOther:$("#ivivuModal textarea[name=modal-other]").val(),Avatar:c,Address:n,Adult:o,Child:d,Troom:h,HotelLink:window.location.protocol+"//"+window.location.host+window.location.pathname,RoomData:r});$.ajax({url:"//pay.ivivu.com/gui-yeu-cau-gia",type:"POST",dataType:"JSON",data:k,contentTyp:"application/json; charset=utf-8",async:!1,crossDomain:!0,success:function(){swal({title:"Gửi yêu cầu thành công!",text:"iVIVU.com sẽ liên hệ với quý khách trong thời gian sớm nhất",timer:8e3,type:"success"})},error:function(){swal({title:"Gửi yêu cầu không thành công!",text:"Vui lòng thử lại hoặc liên hệ hotline (028) 3930 8290",timer:8e3,type:"error"})}}),$("#ivivuModal").modal("hide")}})};return{init:function(){e(),void 0!=Searchbox&&(Searchbox.initDatepicker("datepicker-modal-chkin","datepicker-modal-chkout"),Searchbox.unbindDatepicker(),Searchbox.bindDatepicker())},destroy:function(){void 0!=Searchbox&&Searchbox.destroyDatepicker("datepicker-modal-chkin","datepicker-modal-chkout")},_bindValidate:function(){e()}}}();$(function(){Searchbox.init()});